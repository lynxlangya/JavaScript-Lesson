# 語法專題
# 數據類型的轉換
## 概述
JavaScript 是一種動態類型語言，變量沒有類型限制，可以隨時賦予任意值。
```
let x = y ? 1 : 'a';
```
上面代碼中，變量 `x` 到底是數值還是字符串，取決與另一個變量 `y` 的值。`y` 爲 `true` 時， `x` 是一個數值（1）；`y` 爲 `false` 是， `x` 是一個字符串。 這意味着，`x` 的類型沒法在編譯階段就知道，必須等到運行時才能知道。

雖然變量的數據類型是不確定的，但是各種運算符對數據類型是有要求的。如果運算符發現，運算子的類型與預期不符，就會自動轉換類型。比如，減法運算符預期左右兩側的運算子應該是數值，如果不是，就會自動將它們轉爲數值。
```
'4' - '3'           // 1
```
上面代碼中，雖然是兩個字符串相減，但是依然會得到結果數值 `1`，原因就在於JavaScript 將運算子自動轉爲了數值。

## 強制轉換
強制轉換主要是指使用 `Number()`、`String()`、`Boolean()`三個函數，手動將各種類型的值，分別轉換成數字、字符串或布爾值。

### Number()
使用 `Number()`函數，可以將任意類型的值轉化爲數值。

其中兩種情況，一種是參數是原始類型的值，另一種是參數是對象。

#### 原始類型值
原始類型值的轉換規則如下：
```
// 數值： 轉換後還是原來的值
Number(123)         // 123

// 字符串：如果可以被解析爲數值，則轉換爲相應的數值
Number('123')       // 123

// 字符串：如果不可以被解析爲數值，則返回 NaN
Number('123asd')    // NaN

// 空字符串轉爲 0
Number('')          // 0

// 布爾值：true 轉爲 1， false 轉爲 0
Number(true)        // 1
Number(false)       // 0

// undefined: 轉爲 NaN
Number(undefined)   // NaN

// null: 轉爲 0
Number(null)        // 0
```
`Number` 函數將字符串轉爲數值，要比 `ParseInt` 函數嚴格很多。基本上，只要有一個字符無法轉成數值，整個字符串就會被轉爲 `NaN`

```
Number('22 Marshal')        // NaN

parseInt('22 Marshal')      // 22
```

### 對象
#### Number()
簡單的規則是，`Number`方法的參數是對象時，將返回 `NaN`，除非是包含單個數值的數組。
```
Number({a:1})       // NaN

Number([1,2,3])     // NaN

Number([4])         // 4
```
之所以如此，是因爲 `Number` 背後的轉換規則較爲複雜。

第一步，調用對象自身的 `valueOf` 方法。如果返回原始類型的值，則直接對該值使用 `Number` 函數，不再進行後續步驟。

第二步，如果 `valueOf` 方法返回的還是對象，則改爲調用對象自身的 `toString` 方法。如果 `toString` 方法返回原始類型的值，則對該值使用 `Number` 函數，不再進行後續步驟。

第三步，如果 `toString` 方法返回的是對象，就報錯。

#### String()
`String` 函數可以將任意類型的值轉化成字符串，轉換規則如下

<b>原始類型值</b>
- 數值： 轉爲相應的字符串
- 字符串： 轉換後還是原來的值
- 布爾值： `true` 轉爲字符串  `"true"`,`false` 轉換爲 `"false"`
- undefined： 轉爲字符串 `"undefined"`
- null： 轉爲字符串 `"null"`
```
String(123)         // "123"
String('asd')       // "asd"
String(true)        // "true"
String(undefined)   // "undefined"
String(null)        // null
```
